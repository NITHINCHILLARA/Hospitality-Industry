MEASURES : 

1)
Total Bookings = COUNT(fact_bookings[booking_id])

2)
Total Cancelled Bookings = CALCULATE([Total Bookings],fact_bookings[booking_status]="Cancelled")

3)
Total Capacity = SUM(fact_aggregated_bookings[capacity])

4)
Total Checked Out = CALCULATE([Total Bookings],fact_bookings[booking_status]="Checked Out")

5)
Total no show Bookings = CALCULATE([Total Bookings],fact_bookings[booking_status]="No Show")

6)
Total Succesful Bookings = SUM(fact_aggregated_bookings[successful_bookings])

7)
Revenue = SUM(fact_bookings[revenue_realized])

8)
ADR = DIVIDE( [Revenue], [Total Bookings],0)

9)
ADR WoW change % = 
Var selv = IF(HASONEFILTER(dim_date[wn]),SELECTEDVALUE(dim_date[wn]),MAX(dim_date[wn]))
var revcw = CALCULATE([ADR],dim_date[wn]= selv)
var revpw =  CALCULATE([ADR],FILTER(ALL(dim_date),dim_date[wn]= selv-1))

return
DIVIDE(revcw,revpw,0)-1

10)
Average Rating = AVERAGE(fact_bookings[ratings_given])

11)
Booking % by Platform = DIVIDE([Total Bookings],
 CALCULATE([Total Bookings], 
 ALL(fact_bookings[booking_platform])
  ))*100

12)
Booking % by Room class = DIVIDE([Total Bookings],
 CALCULATE([Total Bookings], 
 ALL(dim_rooms[room_class])
  ))*100

13)
Cancellation % = DIVIDE([Total cancelled bookings],[Total Bookings])

14)
No of days = DATEDIFF(MIN(dim_date[date]),MAX(dim_date[date]),DAY) +1

15)
No Show rate % = DIVIDE([Total no show bookings],[Total Bookings])

16)
DBRN = DIVIDE([Total Bookings], [No of days])

17)
DSRN = DIVIDE([Total Capacity], [No of days])

18)
DSRN WoW change % = 
Var selv = IF(HASONEFILTER(dim_date[wn]),SELECTEDVALUE(dim_date[wn]),MAX(dim_date[wn]))
var revcw = CALCULATE([DSRN],dim_date[wn]= selv)
var revpw =  CALCULATE([DSRN],FILTER(ALL(dim_date),dim_date[wn]= selv-1))

return
DIVIDE(revcw,revpw,0)-1

19)
DURN = DIVIDE([Total Checked Out],[No of days])

20)
Occupancy % = DIVIDE([Total Succesful Bookings],[Total Capacity],0)

21)
Occupancy WoW change % = 
Var selv = IF(HASONEFILTER(dim_date[wn]),SELECTEDVALUE(dim_date[wn]),MAX(dim_date[wn]))
var revcw = CALCULATE([Occupancy %],dim_date[wn]= selv)
var revpw =  CALCULATE([Occupancy %],FILTER(ALL(dim_date),dim_date[wn]= selv-1))

return
DIVIDE(revcw,revpw,0)-1

22)
Realisation % = 1- ([Cancellation %]+[No Show rate %])

23)
Realisation WoW change % = 
Var selv = IF(HASONEFILTER(dim_date[wn]),SELECTEDVALUE(dim_date[wn]),MAX(dim_date[wn]))
var revcw = CALCULATE([Realisation %],dim_date[wn]= selv)
var revpw =  CALCULATE([Realisation %],FILTER(ALL(dim_date),dim_date[wn]= selv-1))

return
DIVIDE(revcw,revpw,0)-1

24)
RevPAR = DIVIDE([Revenue],[Total Capacity])

25)
Revpar WoW change % = 
Var selv = IF(HASONEFILTER(dim_date[wn]),SELECTEDVALUE(dim_date[wn]),MAX(dim_date[wn]))
var revcw = CALCULATE([RevPAR],dim_date[wn]= selv)
var revpw =  CALCULATE([RevPAR],FILTER(ALL(dim_date),dim_date[wn]= selv-1))

return
DIVIDE(revcw,revpw,0)-1
